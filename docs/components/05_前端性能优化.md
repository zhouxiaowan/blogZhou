---
title: 前端性能优化
date: 2021-11-25 15:23
---
# 前端性能优化
首先浏览器是异步获取资源的  
浏览器渲染引擎：  
一个渲染引擎主要包括：HTML解析器，CSS解析器，Javascript解析器，布局Layout模块，绘图模块等  
* HTML解析器：将HTML解析成DOM树
* CSS解析器：解析CSS，构建CSSOM（css样式树）
* JS引擎：绑定事件，修改DOM树和CSS树
* 布局layout：将DOM树和css树合并成一个渲染树
* 绘图模块：根据渲染树来渲染，计算每个节点的几何信息，最终将各个节点绘制到屏幕上  

__css渲染__
1. style标签中的样式
    * 是由html解析器进行解析，是异步解析的
    * 不阻塞浏览器的渲染（但是会可能产生闪屏现象）
    * 不阻塞DOM解析
2. link引入的外部的css样式（推荐使用）
    * 由css解析器进行解析，是同步解析的
    * 阻塞浏览器的渲染，不阻塞DOM的解析
    * 阻塞其后js语气的执行（因为js可以改变样式，同时进行的话可能会有冲突）

__js阻塞__  

1. 阻塞DOM解析  
原因：浏览器不知道后续脚本的内容，如果先去解析了下面的DOM，而随后的js删除了后面的所有的DOM，那么浏览器就做了无用功
2. 阻塞页面的渲染  
原因：js也可以给DOM设置样式，浏览器等待该脚本执行完毕，渲染出一个最终结果，避免做无用功。
3. 阻塞后续js的执行  
原因：维护依赖关系，例如，必须先引入jqury才能使用$  


优化思路1：优化资源加载的顺序，仅加载需要的资源，剩下的资源通过异步加载的方式加载  

优化思路2:减少重排重绘  
重排：布局  
重绘：绘制绘图  
重绘是以图层为单位，如果图层中的某个元素需要重绘，那么整个图层都需要重绘。  
开图层的方法：css：will-change属性，css3动画节点，css3 3D属性，video，canvas。  
减少重排重绘的方法：  

1. 元素位置移动变换尽量使用css3的transform来代替对top，left等的操作。transform的变化仅仅影响图层的组合
2. 将多次改变样式属性的操作合并成一次操作
3. visibility不触发重排，依然重绘；display:none触发重排重绘
## 5.1 网络请求优化
* 缓存
* 合理使用CDN，有效减少网络请求延时
* DNS缓存
* 对资源进行压缩，减少传输数据大小
* 可以使用Http2，Http3提升资源请求速度

CDN称为内容分发网络（Content Distribution Network）
* 它是指通过相互连接的网络系统，利用最靠近每个用户的服务器
* 更快更可靠的将音乐视频图片应用程序及其它文件发送给用户

## 5.2 首屏优化
* 服务端渲染
* 懒加载
* 优化资源加载的顺序，仅加载需要的资源，剩下的资源通过异步加载的方式加载

## 5.3 减少重排重绘
* 使用
